{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/daniele.beribe/src/algoDemo2VitaB/algoDemo/algoDemoFrontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Validators } from '@angular/forms';\nimport { Valutazione } from '../model/valutazione';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../service/utente.service\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"../service/valutazioni.service\";\nimport * as i5 from \"@angular/common\";\nfunction CaHomeComponent_li_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\", 19)(1, \"div\", 20);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 21);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 22);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 23)(8, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function CaHomeComponent_li_15_Template_button_click_8_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r9);\n      const i_r7 = restoredCtx.index;\n      const val_r6 = restoredCtx.$implicit;\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.checkMutability(i_r7 + \"\", val_r6.getIdValutazione()));\n    });\n    i0.ɵɵtext(9, \"check\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const val_r6 = ctx.$implicit;\n    const i_r7 = ctx.index;\n    i0.ɵɵpropertyInterpolate(\"id\", i_r7);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(val_r6.getIdTX());\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(val_r6.getValutazione());\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(val_r6.getNote());\n  }\n}\nfunction CaHomeComponent_h5_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h5\", 25);\n    i0.ɵɵtext(1, \"Compilare i campi sottostanti\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CaHomeComponent_h5_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h5\", 25);\n    i0.ɵɵtext(1, \"Salvando dati su blockchain..\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CaHomeComponent_button_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function CaHomeComponent_button_25_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      ctx_r10.dati.reset();\n      return i0.ɵɵresetView(ctx_r10.error = false);\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CaHomeComponent_div_26_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 34);\n    i0.ɵɵtext(1, \"Dati non inviati alla blockchain, perfavore check\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CaHomeComponent_div_26_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtemplate(1, CaHomeComponent_div_26_span_1_Template, 2, 0, \"span\", 28);\n    i0.ɵɵelementStart(2, \"form\", 29);\n    i0.ɵɵlistener(\"ngSubmit\", function CaHomeComponent_div_26_Template_form_ngSubmit_2_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.invio());\n    });\n    i0.ɵɵelement(3, \"input\", 30)(4, \"input\", 31);\n    i0.ɵɵelementStart(5, \"div\", 32);\n    i0.ɵɵelement(6, \"input\", 33);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.error);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroup\", ctx_r4.dati);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"disabled\", ctx_r4.dati.invalid);\n  }\n}\nfunction CaHomeComponent_div_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 35);\n    i0.ɵɵelement(1, \"div\", 36);\n    i0.ɵɵelementEnd();\n  }\n}\nexport class CaHomeComponent {\n  constructor(router, utenteService, fb, valutazioniService) {\n    this.router = router;\n    this.utenteService = utenteService;\n    this.fb = fb;\n    this.valutazioniService = valutazioniService;\n    this.idUtente = this.utenteService.getId();\n    this.valutazioni = [];\n    this.error = false;\n    this.loading = false;\n    this.nomeUtente = utenteService.getNome();\n    console.log(this.idUtente);\n    this.dati = this.fb.group({\n      note: ['', [Validators.required]],\n      valutazione: ['', [Validators.required, Validators.pattern(\"^[0-5]*$\"), Validators.maxLength(1)]]\n    });\n    if (this.idUtente == 0 || this.idUtente == null) {\n      this.router.navigate(['/login']);\n    }\n    this.loadDati();\n  }\n  checkMutability(num, idTX) {\n    // console.log(num);\n    // const box = document.getElementById(num);\n    //   box?.classList.add('list-group-item-danger');\n    this.valutazioniService.checkValutazione(idTX).subscribe(response => {\n      const box = document.getElementById(num);\n      box?.classList.add('list-group-item-success');\n    }, error => {\n      const box = document.getElementById(num);\n      box?.classList.add('list-group-item-danger');\n    });\n  }\n  invio() {\n    var _this = this;\n    this.loading = true;\n    this.valutazioniService.addValutazione(this.dati.value, this.idUtente).subscribe( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (response) {\n        console.log(response);\n        _this.error = false;\n        _this.loadDati();\n        _this.loading = false;\n        yield _this.delay(1);\n        const x = document.getElementById(\"closeModal\");\n        x?.click();\n      });\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }(), /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(function* (error) {\n        console.log(error);\n        _this.loading = false;\n        _this.error = true;\n      });\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n  }\n  loadDati() {\n    this.valutazioni = [];\n    this.valutazioniService.getAllValutazioneByIdUtente(this.idUtente).subscribe(response => {\n      console.log(response);\n      for (let i = 0; i < response.length; i++) {\n        this.valutazioni.push(new Valutazione(response[i]));\n      }\n      console.log(this.valutazioni);\n    }, error => {});\n  }\n  delay(ms) {\n    console.log(\"dormo\");\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n  static #_ = this.ɵfac = function CaHomeComponent_Factory(t) {\n    return new (t || CaHomeComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.UtenteService), i0.ɵɵdirectiveInject(i3.FormBuilder), i0.ɵɵdirectiveInject(i4.ValutazioniService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CaHomeComponent,\n    selectors: [[\"app-ca-home\"]],\n    decls: 28,\n    vars: 6,\n    consts: [[1, \"container\", \"mt-5\", 2, \"font-size\", \"13px\"], [1, \"list-group\"], [1, \"list-group-item\", \"row\", \"d-flex\", \"justify-content-end\"], [1, \"col-5\", \"mt-2\", \"fw-bold\"], [1, \"text-center\"], [1, \"col-2\", \"mt-2\", \"fw-bold\"], [1, \"col-4\", \"mt-2\", \"fw-bold\"], [1, \"col-1\", \"mt-2\", \"fw-bold\"], [\"class\", \"list-group-item row d-flex\", 3, \"id\", 4, \"ngFor\", \"ngForOf\"], [1, \"d-flex\", \"justify-content-center\", \"mt-5\"], [\"type\", \"button\", \"data-bs-toggle\", \"modal\", \"data-bs-target\", \"#staticBackdrop\", 1, \"btn\", \"btn-primary\"], [\"id\", \"staticBackdrop\", \"data-bs-backdrop\", \"static\", \"data-bs-keyboard\", \"false\", \"tabindex\", \"-1\", \"aria-labelledby\", \"staticBackdropLabel\", \"aria-hidden\", \"true\", 1, \"modal\", \"fade\"], [1, \"modal-dialog\"], [1, \"modal-content\"], [1, \"modal-header\"], [\"class\", \"modal-title\", \"id\", \"staticBackdropLabel\", 4, \"ngIf\"], [\"id\", \"closeModal\", \"type\", \"button\", \"class\", \"btn-close\", \"data-bs-dismiss\", \"modal\", \"aria-label\", \"Close\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"modal-body\", 4, \"ngIf\"], [\"class\", \"modal-body d-flex justify-content-center\", 4, \"ngIf\"], [1, \"list-group-item\", \"row\", \"d-flex\", 3, \"id\"], [1, \"col-5\", \"d-flex\", \"justify-content-center\", \"align-items-center\"], [1, \"col-2\", \"d-flex\", \"justify-content-center\", \"align-items-center\"], [1, \"col-4\", \"d-flex\", \"justify-content-center\", \"align-items-center\"], [1, \"col-1\", \"d-flex\", \"justify-content-center\", \"align-items-center\"], [1, \"btn\", \"btn-info\", 3, \"click\"], [\"id\", \"staticBackdropLabel\", 1, \"modal-title\"], [\"id\", \"closeModal\", \"type\", \"button\", \"data-bs-dismiss\", \"modal\", \"aria-label\", \"Close\", 1, \"btn-close\", 3, \"click\"], [1, \"modal-body\"], [\"class\", \"badge badge-danger mb-2 d-flex justify-content-center\", \"style\", \"background-color: red;\", 4, \"ngIf\"], [3, \"formGroup\", \"ngSubmit\"], [\"type\", \"text\", \"formControlName\", \"note\", \"placeholder\", \"note relative alla valutazione\", 1, \"form-control\", \"mb-2\"], [\"type\", \"text\", \"formControlName\", \"valutazione\", \"placeholder\", \"voto relativo alla valutazione\", 1, \"form-control\"], [1, \"d-flex\", \"justify-content-center\"], [\"type\", \"submit\", \"value\", \"Aggiungi\", 1, \"btn\", \"btn-primary\", \"mt-2\", 3, \"disabled\"], [1, \"badge\", \"badge-danger\", \"mb-2\", \"d-flex\", \"justify-content-center\", 2, \"background-color\", \"red\"], [1, \"modal-body\", \"d-flex\", \"justify-content-center\"], [1, \"loader\"]],\n    template: function CaHomeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"ul\", 1)(2, \"li\", 2)(3, \"div\", 3)(4, \"p\", 4);\n        i0.ɵɵtext(5, \"IdTX\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(6, \"div\", 5)(7, \"p\", 4);\n        i0.ɵɵtext(8, \"Valutazione\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(9, \"div\", 6)(10, \"p\", 4);\n        i0.ɵɵtext(11, \"Note\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"div\", 7)(13, \"p\", 4);\n        i0.ɵɵtext(14, \"Check\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(15, CaHomeComponent_li_15_Template, 10, 4, \"li\", 8);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(16, \"div\", 9)(17, \"button\", 10);\n        i0.ɵɵtext(18, \"Aggiungi valutazione\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(19, \"div\", 11)(20, \"div\", 12)(21, \"div\", 13)(22, \"div\", 14);\n        i0.ɵɵtemplate(23, CaHomeComponent_h5_23_Template, 2, 0, \"h5\", 15);\n        i0.ɵɵtemplate(24, CaHomeComponent_h5_24_Template, 2, 0, \"h5\", 15);\n        i0.ɵɵtemplate(25, CaHomeComponent_button_25_Template, 1, 0, \"button\", 16);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(26, CaHomeComponent_div_26_Template, 7, 3, \"div\", 17);\n        i0.ɵɵtemplate(27, CaHomeComponent_div_27_Template, 2, 0, \"div\", 18);\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(15);\n        i0.ɵɵproperty(\"ngForOf\", ctx.valutazioni);\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngIf\", ctx.loading == false);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.loading == true);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.loading == false);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.loading == false);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.loading == true);\n      }\n    },\n    dependencies: [i5.NgForOf, i5.NgIf, i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.FormGroupDirective, i3.FormControlName],\n    styles: [\".loader[_ngcontent-%COMP%] {\\r\\n    border: 16px solid #f3f3f3; \\r\\n    border-top: 16px solid #3498db; \\r\\n    border-radius: 50%;\\r\\n    width: 120px;\\r\\n    height: 120px;\\r\\n    animation: _ngcontent-%COMP%_spin 2s linear infinite;\\r\\n  }\\r\\n  \\r\\n  @keyframes _ngcontent-%COMP%_spin {\\r\\n    0% { transform: rotate(0deg); }\\r\\n    100% { transform: rotate(360deg); }\\r\\n  }\\r\\n\\r\\n\\r\\n\\r\\n.btn[_ngcontent-%COMP%]:disabled{\\r\\n  background-color: #bcd5fb;\\r\\n\\r\\n}\\n/*# sourceURL=webpack://./src/app/ca-home/ca-home.component.css */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY2EtaG9tZS9jYS1ob21lLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSwwQkFBMEIsRUFBRSxlQUFlO0lBQzNDLDhCQUE4QixFQUFFLFNBQVM7SUFDekMsa0JBQWtCO0lBQ2xCLFlBQVk7SUFDWixhQUFhO0lBQ2Isa0NBQWtDO0VBQ3BDOztFQUVBO0lBQ0UsS0FBSyx1QkFBdUIsRUFBRTtJQUM5QixPQUFPLHlCQUF5QixFQUFFO0VBQ3BDOzs7O0FBSUY7RUFDRSx5QkFBeUI7O0FBRTNCIiwic291cmNlc0NvbnRlbnQiOlsiLmxvYWRlciB7XHJcbiAgICBib3JkZXI6IDE2cHggc29saWQgI2YzZjNmMzsgLyogTGlnaHQgZ3JleSAqL1xyXG4gICAgYm9yZGVyLXRvcDogMTZweCBzb2xpZCAjMzQ5OGRiOyAvKiBCbHVlICovXHJcbiAgICBib3JkZXItcmFkaXVzOiA1MCU7XHJcbiAgICB3aWR0aDogMTIwcHg7XHJcbiAgICBoZWlnaHQ6IDEyMHB4O1xyXG4gICAgYW5pbWF0aW9uOiBzcGluIDJzIGxpbmVhciBpbmZpbml0ZTtcclxuICB9XHJcbiAgXHJcbiAgQGtleWZyYW1lcyBzcGluIHtcclxuICAgIDAlIHsgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7IH1cclxuICAgIDEwMCUgeyB0cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpOyB9XHJcbiAgfVxyXG5cclxuXHJcblxyXG4uYnRuOmRpc2FibGVke1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICNiY2Q1ZmI7XHJcblxyXG59Il0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["Validators","Valutazione","i0","val_r6","ctx_r10","CaHomeComponent","constructor","router","utenteService","fb","valutazioniService","idUtente","getId","valutazioni","error","loading","nomeUtente","getNome","console","log","dati","group","note","required","valutazione","pattern","maxLength","navigate","loadDati","checkMutability","num","idTX","checkValutazione","subscribe","response","box","document","getElementById","classList","add","invio","addValutazione","value","delay","x","click","getAllValutazioneByIdUtente","i","length","push","ms","Promise","resolve","setTimeout","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\daniele.beribe\\src\\algoDemo2VitaB\\algoDemo\\algoDemoFrontend\\src\\app\\ca-home\\ca-home.component.ts","C:\\Users\\daniele.beribe\\src\\algoDemo2VitaB\\algoDemo\\algoDemoFrontend\\src\\app\\ca-home\\ca-home.component.html"],"sourcesContent":["import { ThisReceiver } from '@angular/compiler';\r\nimport { Component } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { Router } from '@angular/router';\r\nimport { Valutazione } from '../model/valutazione';\r\nimport { UtenteService } from '../service/utente.service';\r\nimport { ValutazioniService } from '../service/valutazioni.service';\r\n\r\n@Component({\r\n  selector: 'app-ca-home',\r\n  templateUrl: './ca-home.component.html',\r\n  styleUrls: ['./ca-home.component.css']\r\n})\r\nexport class CaHomeComponent {\r\n  idUtente:any;\r\n  dati: FormGroup;\r\n  loading:boolean;\r\n  error:boolean;\r\n  nomeUtente:any;\r\n \r\n  valutazioni:Valutazione[];\r\n\r\n\r\n  constructor(private router: Router,private utenteService: UtenteService, private fb: FormBuilder, private valutazioniService:ValutazioniService) {\r\n    this.idUtente = this.utenteService.getId();\r\n    this.valutazioni=[];\r\n    this.error=false;\r\n    this.loading=false;\r\n    this.nomeUtente=utenteService.getNome();\r\n    console.log(this.idUtente);\r\n    \r\n\r\n    this.dati = this.fb.group({\r\n      note: ['', [Validators.required]],\r\n      valutazione: ['', [Validators.required,Validators.pattern(\"^[0-5]*$\"), Validators.maxLength(1)]]\r\n    });\r\n\r\n    if(this.idUtente==0 || this.idUtente==null){\r\n      this.router.navigate(['/login']);\r\n    }\r\n\r\n    this.loadDati()\r\n  }\r\n\r\n  checkMutability(num:string,idTX:any):void{\r\n    // console.log(num);\r\n    // const box = document.getElementById(num);\r\n    //   box?.classList.add('list-group-item-danger');\r\n    this.valutazioniService.checkValutazione(idTX).subscribe(\r\n      (response:any) => {\r\n        const box = document.getElementById(num);\r\n        box?.classList.add('list-group-item-success');\r\n\r\n      },\r\n      (error:any) => {\r\n        const box = document.getElementById(num);\r\n        box?.classList.add('list-group-item-danger');\r\n      }\r\n    );\r\n  }\r\n\r\n  invio(){\r\n    this.loading=true;\r\n    this.valutazioniService.addValutazione(this.dati.value,this.idUtente).subscribe(\r\n      async (response:any) => {\r\n        console.log(response)\r\n        this.error=false;\r\n        this.loadDati()\r\n        this.loading=false;\r\n        await this.delay(1);\r\n        const x = document.getElementById(\"closeModal\");\r\n        x?.click();\r\n      },\r\n      async (error:any) => {\r\n        console.log(error)\r\n        this.loading=false;\r\n        this.error=true;\r\n      }\r\n    );\r\n  }\r\n\r\n\r\n  loadDati(){\r\n    this.valutazioni=[];\r\n    this.valutazioniService.getAllValutazioneByIdUtente(this.idUtente).subscribe(\r\n      (response:any) => {\r\n        console.log(response);\r\n        for(let i=0;i<response.length;i++){\r\n          this.valutazioni.push(new Valutazione(response[i]));\r\n        }\r\n        console.log(this.valutazioni);\r\n\r\n      },\r\n      (error:any) => {\r\n\r\n      }\r\n    );\r\n  }\r\n\r\n\r\n  delay(ms: number) {\r\n    console.log(\"dormo\")\r\n    return new Promise( resolve => setTimeout(resolve, ms) );\r\n  }\r\n\r\n\r\n\r\n}\r\n","<div class=\"container mt-5\" style=\"font-size:13px\">\r\n  <ul class=\"list-group\">\r\n    <li class=\"list-group-item row d-flex justify-content-end\">\r\n      <div class=\"col-5 mt-2 fw-bold\">\r\n        <p class=\"text-center\">IdTX</p>\r\n      </div>\r\n      <div class=\"col-2 mt-2 fw-bold\">\r\n        <p class=\"text-center\">Valutazione</p>\r\n      </div>\r\n      <div class=\"col-4 mt-2 fw-bold\">\r\n        <p class=\"text-center\">Note</p>\r\n      </div>\r\n      <div class=\"col-1 mt-2 fw-bold\">\r\n        <p class=\"text-center\">Check</p>\r\n      </div>\r\n    </li>\r\n    <li *ngFor=\"let val of this.valutazioni; index as i;\" class=\"list-group-item row d-flex\" id={{i}}>\r\n      <div class=\"col-5 d-flex justify-content-center align-items-center\">{{val.getIdTX()}}</div>\r\n      <div class=\"col-2 d-flex justify-content-center align-items-center\">{{val.getValutazione()}}</div>\r\n      <div class=\"col-4 d-flex justify-content-center align-items-center\">{{val.getNote()}}</div>\r\n      <div class=\"col-1 d-flex justify-content-center align-items-center\"><button\r\n          (click)=\"checkMutability(i+'',val.getIdValutazione())\" class=\"btn btn-info\">check</button></div>\r\n    </li>\r\n  </ul>\r\n</div>\r\n\r\n<div class=\"d-flex justify-content-center mt-5\">\r\n  <button type=\"button\" class=\"btn btn-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#staticBackdrop\">Aggiungi\r\n    valutazione</button>\r\n</div>\r\n\r\n\r\n\r\n\r\n<!-- Modal -->\r\n<div class=\"modal fade\" id=\"staticBackdrop\" data-bs-backdrop=\"static\" data-bs-keyboard=\"false\" tabindex=\"-1\"\r\n  aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h5 *ngIf=\"this.loading==false\" class=\"modal-title\" id=\"staticBackdropLabel\">Compilare i campi sottostanti</h5>\r\n        <h5 *ngIf=\"this.loading==true\" class=\"modal-title\" id=\"staticBackdropLabel\">Salvando dati su blockchain..</h5>\r\n        <button id=\"closeModal\" *ngIf=\"this.loading==false\" type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"\r\n          aria-label=\"Close\" (click)=\"this.dati.reset(); this.error=false\"></button>\r\n      </div>\r\n      <div *ngIf=\"this.loading==false\" class=\"modal-body\">\r\n        <span class=\"badge badge-danger mb-2 d-flex justify-content-center\" style=\"background-color: red;\" *ngIf=\"this.error\">Dati non inviati alla blockchain, perfavore check</span>\r\n        <form [formGroup]=\"dati\" (ngSubmit)=\"invio()\">\r\n          <input type=\"text\" class=\"form-control mb-2\" formControlName=\"note\"\r\n            placeholder=\"note relative alla valutazione\" />\r\n          <input type=\"text\" class=\"form-control\" formControlName=\"valutazione\"\r\n            placeholder=\"voto relativo alla valutazione\" />\r\n          <div class=\"d-flex justify-content-center\">\r\n            <input type=\"submit\" class=\"btn btn-primary mt-2\" value=\"Aggiungi\" [disabled]=\"dati.invalid\" />\r\n          </div>\r\n        </form>\r\n\r\n\r\n      </div>\r\n      <div *ngIf=\"this.loading==true\" class=\"modal-body d-flex justify-content-center\">\r\n        <div class=\"loader\"></div>\r\n      </div>\r\n\r\n\r\n    </div>\r\n  </div>\r\n</div>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}